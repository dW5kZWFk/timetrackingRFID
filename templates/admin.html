<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Arbeitszeiterfassung-Verwaltung</title>
    <script
			  src="https://code.jquery.com/jquery-3.6.1.js"
			  integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI="
			  crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.29.0/feather.min.js" integrity="sha512-24XP4a9KVoIinPFUbcnjIjAjtS59PUoxQj3GNVpWc86bCqPuy3YxAcxJrxFCxXe4GHtAumCbO2Ze2bddtuxaRw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<div class="alert alert-danger alert-dismissible" id="ajax_flash_danger" role="alert" style="display:none;">
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"><span aria-hidden="true"></span></button>
      <div id="ajax_flash_danger_msg"></div>
</div>

<div class="alert alert-success alert-dismissible" id="ajax_flash_success" role="alert" style="display:none;">
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"><span aria-hidden="true"></span></button>
      <div id="ajax_flash_success_msg"></div>
</div>

</head>
<body>


<button type="button" class="btn btn-outline-dark ms-2"  data-bs-toggle="tooltip" onclick="save_csv_ajax();" data-bs-placement="bottom" title="CSV-Datei aus Arbeitszeiten erstellen.">
                    <i class="feather-16" data-feather="save"></i>
</button>
<br>
 <span id="csv_download_link" style="display:none;">
                <a href="{{ url_for('working_time')}}">Download CSV</a>
 </span>

<br>
<div id="reset_worktime_table">
    <form method="POST">
        <button type="submit" name="reset_worktime" class="btn btn-danger ms-2"  data-bs-toggle="tooltip" data-bs-placement="bottom" >
                    Arbeitszeiten Tabelle zurücksetzen
        </button>

    </form>

</div>


</body>

<script>

$(document).ready(function() {
  feather.replace();
});

function save_csv_ajax() {

    $.ajax({
    					url: "{{ url_for( 'create_csv_ajax' ) }}",
    					type: "GET",
    					data: {},
    					success: function(resp){
    					    if(resp=='error'){
					            $('#ajax_flash_danger').show();
					            $('#ajax_flash_danger_msg').html("Fehler beim erzeugen der CSV Datei (create_csv_ajax)");
                                return;
					        }

                            if(resp=='success'){
					            $('#csv_download_link').show();
					            $('#ajax_flash_danger').show();
					            $('#ajax_flash_danger_msg').html("Arbeitszeiten Tabelle zurücksetzen!");
					            $('#reset_work_time_table').show();
					            feather.replace();
					            return;
                            }
                        }
    	});
}

</script>
</html>